<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=fa data-palette=blue><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>نمایش لیست همه جدول‌ها در SQL Server - وبلاگ آرمان حسن پور</title><link rel=apple-touch-icon href=/images/icons/icon-180x180.png sizes=180x180><link rel=icon href=/images/icons/icon-192x192.png sizes=192x192 type=image/png><link rel=icon href=/images/icons/icon-32x32.png sizes=32x32 type=image/png><link rel=icon href=/images/icons/icon-16x16.png sizes=16x16 type=image/png><link rel=icon href=/images/icons/favicon.ico><link rel=manifest href=/manifest.json><meta name=keywords content><meta name=description content="با توجه به نسخه SQL Server روش جستجو و بازگرداندن لیستی از تمام جدول‌های ایجاد شده توسط کاربر کمی متفاوت است. در این مطلب به طور خلاصه پرس‌و‌جوهایی را بررسی خواهیم کرد که می‌توانند برای بازیابی لیست جدول‌ها در همه نسخه‌ها استفاده شوند."><meta name=robots content="index, follow"><meta itemprop=name content="نمایش لیست همه جدول‌ها در SQL Server"><meta itemprop=description content="با توجه به نسخه SQL Server روش جستجو و بازگرداندن لیستی از تمام جدول‌های ایجاد شده توسط کاربر کمی متفاوت است. در این مطلب به طور خلاصه پرس‌و‌جوهایی را بررسی خواهیم کرد که می‌توانند برای بازیابی لیست جدول‌ها در همه نسخه‌ها استفاده شوند."><meta itemprop=datePublished content="2019-08-01T15:12:29+03:30"><meta itemprop=dateModified content="2019-08-01T15:12:29+03:30"><meta itemprop=wordCount content="484"><meta itemprop=keywords content="SQLServer,SQL"><meta property="og:url" content="/posts/sql-server-show-all-tables/"><meta property="og:site_name" content="وبلاگ آرمان حسن پور"><meta property="og:title" content="نمایش لیست همه جدول‌ها در SQL Server"><meta property="og:description" content="با توجه به نسخه SQL Server روش جستجو و بازگرداندن لیستی از تمام جدول‌های ایجاد شده توسط کاربر کمی متفاوت است. در این مطلب به طور خلاصه پرس‌و‌جوهایی را بررسی خواهیم کرد که می‌توانند برای بازیابی لیست جدول‌ها در همه نسخه‌ها استفاده شوند."><meta property="og:locale" content="fa_ir"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-08-01T15:12:29+03:30"><meta property="article:modified_time" content="2019-08-01T15:12:29+03:30"><meta property="article:tag" content="SQLServer"><meta property="article:tag" content="SQL"><meta name=twitter:card content="summary"><meta name=twitter:title content="نمایش لیست همه جدول‌ها در SQL Server"><meta name=twitter:description content="با توجه به نسخه SQL Server روش جستجو و بازگرداندن لیستی از تمام جدول‌های ایجاد شده توسط کاربر کمی متفاوت است. در این مطلب به طور خلاصه پرس‌و‌جوهایی را بررسی خواهیم کرد که می‌توانند برای بازیابی لیست جدول‌ها در همه نسخه‌ها استفاده شوند."><meta property="og:image" content="/false"><meta name=twitter:image content="/false"><link rel=stylesheet href="/assets/main/bundle.min.1c12b0a07298593a05c8e11601121ccb4a60880f06ecf4320021add9defc2cfb.css" crossorigin=anonymous><link rel=stylesheet href=/assets/viewer/bundle.min.f05183267bb952fbc8c63a7178364de2951614ab71d544ec1068ad36c7447ccc.css crossorigin=anonymous><script async src="https://www.googletagmanager.com/gtag/js?id=G-M2V2LN2RH7"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-M2V2LN2RH7")</script></head><body><script>const items=["mode","palette"];items.forEach(function(e){const t=localStorage.getItem("hbs-"+e);t&&document.body.parentElement.setAttribute("data-"+e,t)})</script><header><nav class="navbar top-app-bar top-app-bar-expand-lg fixed-top"><div class=container><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<i class="fas fa-bars"></i>
</button><a class="navbar-brand flex-grow-1 flex-lg-grow-0 text-center text-lg-start mx-auto ms-lg-5" href=/>وبلاگ آرمان حسن پور</a><div class="offcanvas offcanvas-bottom surface" tabindex=-1 id=offcanvasSocialShare aria-labelledby=offcanvasSocialShare><div class=offcanvas-header><h3 class=offcanvas-title>Share</h3><button type=button class="btn btn-sm btn-outline-primary" data-bs-dismiss=offcanvas aria-label=Close>
<i class="fas fa-times"></i></button></div><div class=offcanvas-body><a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Twitter Share Button" target=_blank href="https://twitter.com/intent/tweet?title=%d9%86%d9%85%d8%a7%db%8c%d8%b4%20%d9%84%db%8c%d8%b3%d8%aa%20%d9%87%d9%85%d9%87%20%d8%ac%d8%af%d9%88%d9%84%e2%80%8c%d9%87%d8%a7%20%d8%af%d8%b1%20SQL%20Server&url=%2fposts%2fsql-server-show-all-tables%2f"><i class="fab fa-fw fa-twitter"></i> Twitter
</a><a class="btn btn-sm btn-outline-primary social-share-button" rel="noopener noreferrer" aria-label="Facebook Share Button" target=_blank href="https://www.facebook.com/sharer/sharer.php?u=%2fposts%2fsql-server-show-all-tables%2f"><i class="fab fa-fw fa-facebook-f"></i> Facebook</a></div></div><div class="collapse navbar-collapse" tabindex=-1 id=navbarSupportedContent aria-labelledby=navbarSupportedContent><form class="search-bar my-1" action=/search><div class="input-group input-group-sm"><span class="btn btn-search disabled position-absolute left-0"><i class="fas fa-fw fa-search"></i></span>
<input class="form-control search-bar-input" name=q type=search aria-label=Search></div></form><ul class="navbar-nav me-auto"><li class=nav-item><a class=nav-link href=/series/><i class="fas fa-fw fa-columns"></i>گروه‌ها</a></li><li class=nav-item><a class=nav-link href=/archives/><i class="fas fa-fw fa-file-archive"></i>بایگانی</a></li><li class=nav-item><a class=nav-link href=/categories/><i class="fas fa-fw fa-folder"></i>دسته‌بندی‌ها</a></li><li class=nav-item><a class=nav-link href=/tags/><i class="fas fa-fw fa-tags"></i>برچسب‌ها</a></li></ul></div></div></nav></header><main class=container><div class="row content"><div class=col-lg-9><div class=container><nav class="row card component" aria-label=breadcrumb><div class=card-body><ol class=breadcrumb><li class=breadcrumb-item><a href=/>خانه</a></li><li class=breadcrumb-item><a href=/posts/>نوشته‌ها</a></li><li class="breadcrumb-item active">نمایش لیست همه جدول‌ها در SQL Server</li></ol></div></nav><article class="row card component mb-4 post"><div class=card-header><h1 class="card-title post-title">نمایش لیست همه جدول‌ها در SQL Server</h1></div><div class=card-body><div class=post-meta><span class=post-date title="ایجاد شده در 2019-08-01 11:42:29 +0000 UTC.">اوت 1, 2019
</span><span class=post-taxonomies><a href=/tags/sqlserver/ class="badge post-taxonomy">SQLServer</a><a href=/tags/sql/ class="badge post-taxonomy">SQL</a></span></div><div class="post-content mb-3"><p>با توجه به نسخه SQL Server روش جستجو و بازگرداندن لیستی از تمام جدول‌های ایجاد شده توسط کاربر کمی متفاوت است. در این مطلب به طور خلاصه پرس‌و‌جوهایی را بررسی خواهیم کرد که می‌توانند برای بازیابی لیست جدول‌ها در همه نسخه‌ها استفاده شوند.</p><h2 id=نسخه-2000>نسخه 2000<a class="anchor ms-1" href=#نسخه-2000><i class="fas fa-link"></i></a></h2><p>برای نسخه‌های قدیمی‌تر SQL Server (مانند SQL Server 2000، اگرچه این روش در SQL Server 2005 برای سازگاری با نسخه‌های قبلی نیز پشتیبانی می‌شود)، باید از یک View به نام SYS.SYSOBJECTS استفاده نمایید. این View شامل یک ردیف برای هر شی می‌باشد که در بانک اطلاعاتی ایجاد شده است، از جمله Viewها، stored procedureها و جدول‌ها. جدول‌هایی که کاربر ایجاده کرده است نیز قابل تفکیک از جدول‌های سیستمی هستند.</p><p>در SYSOBJECTS ستون‌های دیگری نیز وجود دارد زیرا باید اطلاعاتی در مورد هر چیزی که در طول زمان به بانک اطلاعاتی اضافه شده است را در خود نگهداری نماید. بنابراین، برای یافتن لیستی از جدول‌های ایجاد شده توسط کاربر (و تفکیک آن از جدول‌های سیستم)، باید نتایجی را پیدا کنیم که در آن ستون xtype (که نوع شی را برای آن ردیف مشخص می‌کند) برابر با مقدار U است که به معنای جدول‌های کاربر است. دستور TSQL حاصل باید به شکل زیر باشد:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=ln>1</span><span class=cl><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w>  </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w></span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=w>  </span><span class=n>SYSOBJECTS</span><span class=w>
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w>
</span></span></span><span class=line><span class=ln>6</span><span class=cl><span class=w>  </span><span class=n>xtype</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;U&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>7</span><span class=cl><span class=w></span><span class=k>GO</span><span class=w>
</span></span></span></code></pre></div><p>از آنجایی که SYSOBJECTS بخشی از فضای نام SYS است، هنگام پرس‌و‌جو از SYSOBJECTS، تعیین اینکه SYSOBJECTS بخشی از فضای نام سراسری SYS است، غیر ضروری است، بنابراین می‌توانیم آن را همانطور که در مثال بالا نشان داده شده است حذف نماییم.</p><p>مثال بالا لیستی از نتایج تمامی جدول‌ها ایجاد شده توسط کاربر را باز می‌گرداند. از آنجایی که تعداد ستون‌‌هایی که هنگام پرس‌و‌جو از همه ستون‌ها بازگردانده می‌شود بسیار زیاد است، ممکن است بخواهید نتایج را تنها با مشاهده ستون نام و cdate (تاریخ ایجاد) محدود کنید:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=ln>1</span><span class=cl><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w>  </span><span class=n>name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w>  </span><span class=n>crdate</span><span class=w>
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=w></span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=w>  </span><span class=n>SYSOBJECTS</span><span class=w>
</span></span></span><span class=line><span class=ln>6</span><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w>
</span></span></span><span class=line><span class=ln>7</span><span class=cl><span class=w>  </span><span class=n>xtype</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;U&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>8</span><span class=cl><span class=w></span><span class=k>GO</span><span class=w>
</span></span></span></code></pre></div><h2 id=نسخه-2005-به-بالا>نسخه 2005 به بالا<a class="anchor ms-1" href=#نسخه-2005-به-بالا><i class="fas fa-link"></i></a></h2><p>فهرست کردن نام تمام جدول‌ها در SQL Server در نسخه‌های 2005 به بالا با استفاده از یک View به نام INFORMATION_SCHEMA امکان‌پذیر است که به طور خودکار در SQL Server ساخته می‌شود. این View به شما این امکان را می‌دهد که به راحتی طیف گسترده‌ای از metadata از اشیاء موجود در SQL Server را مشاهده نمایید از جمله اطلاعاتی در مورد ستون‌ها، stored procedureها، و حتی جدول‌ها. در هنگام استفاده از این View چهار ستون بازگردانده می‌شود، که مهمترین ستون آن TABLE_TYPE است که تعیین می‌کند موجودیت آن سطر یک جدول یا یک View است.</p><p>برای برگرداندن همه جدول‌ها و Viewها در یک پرس‌و‌جو، عبارت TSQL زیر را اجرا کنید:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=ln>1</span><span class=cl><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w>  </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w></span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=w>  </span><span class=n>INFORMATION_SCHEMA</span><span class=p>.</span><span class=n>TABLES</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=w></span><span class=k>GO</span><span class=w>
</span></span></span></code></pre></div><p>برای برگرداندن همه جدول‌ها و Viewهای یک بانک اطلاعاتی در یک پرس‌و‌جو، عبارت TSQL زیر را اجرا کنید:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=ln>1</span><span class=cl><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w>  </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w></span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=w>  </span><span class=n>databaseName</span><span class=p>.</span><span class=n>INFORMATION_SCHEMA</span><span class=p>.</span><span class=n>TABLES</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=w></span><span class=k>GO</span><span class=w>
</span></span></span></code></pre></div><p>اگر می‌خواهید فقط جدول‌های کاربر را مشاهده نمایید عبارت TSQL زیر را اجرا کنید:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=ln>1</span><span class=cl><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=w>  </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=w></span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=w>  </span><span class=n>databaseName</span><span class=p>.</span><span class=n>INFORMATION_SCHEMA</span><span class=p>.</span><span class=n>TABLES</span><span class=w>
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w>
</span></span></span><span class=line><span class=ln>6</span><span class=cl><span class=w>  </span><span class=n>TABLE_TYPE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;BASE TABLE&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=ln>7</span><span class=cl><span class=w></span><span class=k>GO</span><span class=w>
</span></span></span></code></pre></div></div></div></article><section class="related-posts row card component"><div class=card-header><h2 class=card-title>نوشته‌های مرتبط</h2></div><div class=card-body><ul class=post-list><li><a href=/posts/sql-server-turnover/>گزارش صورت حساب در SQL
</a><span class="float-start post-date">ژوئیهٔ 2, 2020</span></li><li><a href=/posts/sql-server-search-in-tables/>جستجو در همه جدول‌ها در SQL Server
</a><span class="float-start post-date">فوریهٔ 9, 2020</span></li><li><a href=/posts/sql-server-clr/>استفاده از CLR در SQL Server
</a><span class="float-start post-date">فوریهٔ 7, 2020</span></li><li><a href=/posts/oracle-load-java/>استفاده از زبان برنامه‌نویسی Java در بانک اطلاعاتی Oracle
</a><span class="float-start post-date">ژانویهٔ 15, 2023</span></li><li><a href=/posts/oracle-lisagg/>نمایش نتایج پرس‌و‌جوها به صورت یک مقدار جداشده با کاما در Oracle
</a><span class="float-start post-date">فوریهٔ 5, 2019</span></li></ul></div></section></div></div><aside class="col-lg-3 sidebar d-flex"><div class="container d-flex flex-column"><div class="card row text-center profile component"><div class=card-body><div class="col-12 d-flex align-items-center justify-content-center"><img class="profile-avatar rounded-circle" alt="آرمان حسن پور" src=/images/profile.webp loading=lazy data-viewer-invisible width=120 height=120></div><div class="col-12 profile-meta"><div class=profile-name>آرمان حسن پور</div><div class=profile-bio>برنامه نویس فول استک</div><div class=profile-about><i class="fas fa-fw fa-user"></i><a href=/about/>در مورد من</a></div><div class=profile-contact><i class="fas fa-fw fa-question-circle"></i><a href=/contact/>تماس با من</a></div><nav class="social-links nav justify-content-center"><a class="nav-link social-link" href=mailto:arman.hassanpoor2000@gmail.com title=Email><i class="fas fa-fw fa-2x fa-envelope"></i>
</a><a class="nav-link social-link" target=_blank href=https://github.com/arman-hpp title=GitHub rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-github"></i>
</a><a class="nav-link social-link" target=_blank href=https://linkedin.com/in/arsin title=LinkedIn rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-linkedin-in"></i>
</a><a class="nav-link social-link" target=_blank href=https://twitter.com/arman_hasanpour title=Twitter rel="noopener noreferrer"><i class="fa-fw fa-2x fab fa-twitter"></i>
</a><a class="nav-link social-link" target=_blank href=/index.xml title=RSS rel="noopener noreferrer"><i class="fas fa-fw fa-2x fa-rss"></i></a></nav></div></div></div><section class="recent-posts row card component"><div class=card-header><h2 class=card-title>نوشته‌های اخیر</h2></div><div class=card-body><ul class=post-list><li><a href=/posts/oracle-load-java/>استفاده از زبان برنامه‌نویسی Java در بانک اطلاعاتی Oracle</a></li><li><a href=/posts/bill-generator/>ایجاد شناسه قبض و شناسه پرداخت در سی‌شارپ</a></li><li><a href=/posts/unicode-farsi/>یونی‌کُد فارسی</a></li><li><a href=/posts/compare-floats/>مقایسه دو مقدار ممیز شناور در CSharp</a></li><li><a href=/posts/sql-server-turnover/>گزارش صورت حساب در SQL</a></li></ul></div></section><section class="categories-taxonomies row card component"><div class=card-header><h2 class=card-title><a href=/categories>دسته‌بندی‌ها</a></h2></div><div class=card-body><div class=py-2><a href=/categories/general/ class="badge rounded post-taxonomy" title=General>General</a><a href=/categories/sql/ class="badge rounded post-taxonomy" title=SQL>
SQL</a><a href=/categories/csharp/ class="badge rounded post-taxonomy" title=CSharp>
CSharp</a><a href=/categories/dotnet/ class="badge rounded post-taxonomy" title=DotNet>
DotNet</a><a href=/categories/sqlserver/ class="badge rounded post-taxonomy" title=SQLServer>
SQLServer</a><a href=/categories/oop/ class="badge rounded post-taxonomy" title=OOP>
OOP</a><a href=/categories/oracle/ class="badge rounded post-taxonomy" title=Oracle>
Oracle</a><a href=/categories/design-patterns/ class="badge rounded post-taxonomy" title="Design Patterns">
Design Patterns</a><a href=/categories/float/ class="badge rounded post-taxonomy" title=Float>
Float</a><a href=/categories/java/ class="badge rounded post-taxonomy" title=Java>
Java</a><a href=/categories class="badge rounded post-taxonomy" title=ALL>
ALL
<span class="badge badge-sm custom-badge text-white bg-accent me-1">12</span></a></div></div></section><section class="tags-taxonomies row card component"><div class=card-header><h2 class=card-title><a href=/tags>برچسب‌ها</a></h2></div><div class=card-body><div class=py-2><a href=/tags/sql/ class="badge rounded post-taxonomy" title=SQL>SQL</a><a href=/tags/csharp/ class="badge rounded post-taxonomy" title=CSharp>
CSharp</a><a href=/tags/dotnet/ class="badge rounded post-taxonomy" title=DotNet>
DotNet</a><a href=/tags/sqlserver/ class="badge rounded post-taxonomy" title=SQLServer>
SQLServer</a><a href=/tags/oracle/ class="badge rounded post-taxonomy" title=Oracle>
Oracle</a><a href=/tags/farsi/ class="badge rounded post-taxonomy" title=Farsi>
Farsi</a><a href=/tags/float/ class="badge rounded post-taxonomy" title=Float>
Float</a><a href=/tags/guid/ class="badge rounded post-taxonomy" title=GUID>
GUID</a><a href=/tags/ip/ class="badge rounded post-taxonomy" title=IP>
IP</a><a href=/tags/object/ class="badge rounded post-taxonomy" title=Object>
Object</a><a href=/tags class="badge rounded post-taxonomy" title=ALL>
ALL
<span class="badge badge-sm custom-badge text-white bg-accent me-1">45</span></a></div></div></section></div></aside></div></main><footer class="footer mt-auto py-3 text-center container"><div class="copyright mb-2">تمام حقوق این سایت متعلق به آرمان حسن پور می باشد و کپی با ذکر منبع بلامانع است.</div><div class="powered-by mb-2">با افتخار نیرو گرفته از <a href=https://gohugo.io target=_blank rel="noopener noreferrer">Hugo</a>.</div></footer><script src=/assets/main/bundle.min.b1793f7334ce3faaf3ac3f2218f8c6644a97a3d962fc789f23988a690427b9d2.js crossorigin=anonymous defer></script><script src=/assets/icons/bundle.min.657f7a4120128461f03ae5bbbacd85484ec08007f8c87b7fe978e44ffe96b1f8.js crossorigin=anonymous defer></script><script>"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/service-worker.min.js").then(function(e){console.log("Successfully registered service worker",e)}).catch(function(e){console.warn("Error whilst registering service worker",e)})})</script><script src=/assets/viewer/bundle.min.5746442bd3d8363319790eb4ed0e344bbebbdb1bb609f4f971d282177b68e6f7.js crossorigin=anonymous defer></script></body></html>